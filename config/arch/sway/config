# Read `man 5 sway` for a complete reference.

### Variables #################################################################

# This is the main mod key with which to control Sway.
# Mod1 = Alt
# Mod4 = Super
set $mod        Mod1

# Vim-friendly home row direction keys.
set $left       h
set $down       j
set $up         k
set $right      l

# Applications
set $term       wezterm
set $browser    firefox
set $launcher   '~/.local/bin/rofi-start'

# Catppuccin Macchiato color scheme
set $rosewater  #f4dbd6
set $flamingo   #f0c6c6
set $pink       #f5bde6
set $mauve      #c6a0f6
set $red        #ed8796
set $maroon     #ee99a0
set $peach      #f5a97f
set $yellow     #eed49f
set $green      #a6da95
set $teal       #8bd5ca
set $sky        #91d7e3
set $sapphire   #7dc4e4
set $blue       #8aadf4
set $lavender   #b7bdf8
set $text       #cad3f5
set $subtext1   #b8c0e0
set $subtext0   #a5adcb
set $overlay2   #939ab7
set $overlay1   #8087a2
set $overlay0   #6e738d
set $surface2   #5b6078
set $surface1   #494d64
set $surface0   #363a4f
set $base       #24273a
set $mantle     #1e2030
set $crust      #181926
set $grey       #6e738d

### Window assignments ########################################################

# Workspace assignments (auto-move to workspace on open)
# Get a list of app IDs with `swaymsg -t get_tree`.
assign [app_id="^org.wezfurlong.wezterm$"] workspace number 1
assign [app_id="Firefox"] workspace number 2
assign [app_id="librewolf"] workspace number 2
assign [class="discord"] workspace number 3
assign [app_id="^Spotify$"] workspace number 4

# Floating windows
for_window [window_role="pop-up"] floating enable
for_window [window_role="dialog"] floating enable
for_window [app_id="pavucontrol"] floating enable
for_window [app_id="blueman-manager"] floating enable
for_window [app_id="floating-term"] floating enable
for_window [app_id="Firefox" title=".*Extension.*"] floating enable
for_window [app_id="librewolf" title=".*Extension.*"] floating enable

# Press 'q' to close floating-term windows
# NOTE: Conflicts with WezTerm/nvim so in comment for now.
# bindsym --no-repeat q [app_id="floating-term" con_id=__focused__] kill

### Displays and window output ################################################

# kanshi handles automatic dp configuration when monitors connect/disconnect.
exec_always pkill kanshi; kanshi

# You can get the names of your outputs by running `swaymsg -t get_outputs`.
# Display configuration is handled by kanshi (~/.config/kanshi/config)
output * bg ~/Pictures/wallpapers/dune-catppuccin.jpg fill

# Borders & gaps
smart_borders off
default_border pixel 2
gaps inner 8

# Drag windows by holding down $mod and lmb.
# Resize them with rmb + $mod.
# Works for all windows, despite the name.
# Change normal to inverse to use lmb for resizing and rmb for dragging.
floating_modifier $mod normal

# Window colors           border     bg     text       indicator   child_border
client.focused            $lavender  $base  $text      $lavender   $lavender
client.focused_inactive   $surface1  $base  $subtext1  $surface1   $surface1
client.unfocused          $grey      $base  $overlay0  $grey       $grey
client.urgent             $red       $base  $text      $red        $red
client.placeholder        $base      $base  $text      $base       $base
client.background         $base

# Idle configuration
# 1. Lock screen after 300 seconds of inactivity.
# 2. Turn off displays after another 300 seconds.
# 3. Lock screen before the computer sleeps.
# 4. Turn screens back on when resumed.
exec swayidle -w \
  timeout 300 'swaylock -f -c 000000' \
  timeout 600 'swaymsg "output * power off"' \
  resume 'swaymsg "output * power on"' \
  before-sleep 'swaylock -f -c 000000'

# Clipboard manager (supports text and images)
exec wl-paste --type text --watch cliphist store
exec wl-paste --type image --watch cliphist store

# Input configuration
input type:touchpad {
  dwt enabled
  tap enabled
  natural_scroll disabled
  middle_emulation enabled
}

input type:pointer {
  pointer_accel -0.5
}

# To configure keyboard layouts e.a.
# Read `man 5 sway-input` for more info.
#
#   input type:keyboard {
#       xkb_layout "eu"
#   }

### Launchers #################################################################

bindsym $mod+Return exec $term
bindsym $mod+Space exec $launcher
bindsym $mod+u exec $browser
bindsym $mod+c exec cliphist list | ~/.local/bin/rofi-start --dmenu --theme style-5-no-indent | cliphist decode | wl-copy

### Actions ###################################################################

## Close window
bindsym $mod+q kill
# Make the current focus fullscreen.
bindsym $mod+f fullscreen
# You can "split" the current object of your focus. As an example, if you want
# top open your terminal in a vertical split, you do Mod+v+Return.
bindsym $mod+b splith
bindsym $mod+v splitv
## Resize mode (see "Resizing" below)
bindsym $mod+r mode "resize"
## Reload sway config
bindsym $mod+Shift+r reload
bindsym mod4+Shift+p exec ~/.local/bin/rofi-start --powermenu
## Exit sway (logs you out of your Wayland session)
bindsym $mod+Shift+q exec \
  swaynag \
  -t warning \
  -m 'You pressed the exit shortcut. Do you really want to exit sway? \
      This will end your Wayland session.' \
  -B 'Yes, exit sway' 'swaymsg exit'

# Focus windows
bindsym $mod+$left focus left
bindsym $mod+$down focus down
bindsym $mod+$up focus up
bindsym $mod+$right focus right
# Same, but with the arrow keys.
bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right

# Move windows
bindsym $mod+Shift+$left move left
bindsym $mod+Shift+$down move down
bindsym $mod+Shift+$up move up
bindsym $mod+Shift+$right move right
# Same, but with the arrow keys.
bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right

# Switch the current container between different layout styles
# NOTE: Disabled since I just want tiling for now, but might experiment later.
# bindsym $mod+s layout stacking
# bindsym $mod+w layout tabbed
# bindsym $mod+e layout toggle split

# Toggle window from tiled to floating (or vice versa).
bindsym $mod+Shift+space floating toggle
# Switch focus from tiling area to floating area.
bindsym $mod+Shift+f focus mode_toggle
# Move focus to the parent container. I'm not entirely sure what the use case
# is for this yet; you can select multiple floating area.
bindsym $mod+a focus parent

### Workspaces ################################################################

# Note: workspaces can have string names as well.
# 7-10 are disabled because I might use those as app launchers.

# Switch to workspace
bindsym $mod+bracketleft workspace prev
bindsym $mod+bracketright workspace next

# Move focused container to workspace
bindsym $mod+Shift+1 move container to workspace number 1
bindsym $mod+Shift+2 move container to workspace number 2
bindsym $mod+Shift+3 move container to workspace number 3
bindsym $mod+Shift+4 move container to workspace number 4
bindsym $mod+Shift+5 move container to workspace number 5
bindsym $mod+Shift+6 move container to workspace number 6

### Scratchpad ################################################################

# This is a Sway feature, like a Bag of Holding for windows.
# You can send windows there and get them back later.

# Move the currently focused window to the scratchpad
bindsym $mod+Shift+minus move scratchpad

# Show the next scratchpad window or hide the focused scratchpad window.
# If there are multiple scratchpad windows, this command cycles through them.
bindsym $mod+minus scratchpad show

### Resizing ##################################################################

mode "resize" {
  # left will shrink the containers width
  # right will grow the containers width
  # up will shrink the containers height
  # down will grow the containers height
  bindsym $left resize shrink width 10px
  bindsym $right resize grow width 10px
  bindsym $up resize grow height 10px
  bindsym $down resize shrink height 10px

  # Ditto, with arrow keys
  bindsym Left resize shrink width 10px
  bindsym Down resize grow height 10px
  bindsym Up resize shrink height 10px
  bindsym Right resize grow width 10px

  # Return to default mode
  bindsym Return mode "default"
  bindsym Escape mode "default"
}

### Utilities #################################################################

# Adjust volume via PulseAudio
# --locked means this works when the computer is in a locked state.
# \@DEFAULT_SINK@ and \@DEFAULT_SOURCE@ are special targets referrig to my
# default audio output/input devices.
bindsym --locked XF86AudioMute exec pactl set-sink-mute \@DEFAULT_SINK@ toggle
bindsym --locked XF86AudioLowerVolume exec pactl set-sink-volume \@DEFAULT_SINK@ -5%
bindsym --locked XF86AudioRaiseVolume exec pactl set-sink-volume \@DEFAULT_SINK@ +5%
bindsym --locked XF86AudioMicMute exec pactl set-source-mute \@DEFAULT_SOURCE@ toggle

# Adjust brightness via brightnessctl
bindsym --locked XF86MonBrightnessDown exec brightnessctl set 5%-
bindsym --locked XF86MonBrightnessUp exec brightnessctl set 5%+

# Screenshots
bindsym $mod+p exec grim ~/Pictures/Screenshots/$(date +%Y%m%d_%H%M%S).png
bindsym $mod+Shift+p exec grim -g "$(slurp)" - | wl-copy

## Alt+Tab window switching (swtchr)
# Uses a Sway mode to prevent key consumption while swtchr is open.
# Releasing Alt switches to the selected window.
bindsym $mod+Tab mode swtchr; exec swtchr
mode swtchr bindsym Escape mode default

# Status Bar
# Read `man 5 sway-bar` for more info.
# I use waybar, so no need for the default status bar. I'll leave an example
# below though.
# bar {
#     position top
#
#     # When the status_command prints a new line to stdout, swaybar updates.
#     # The default just shows the current date and time.
#     status_command while date +'%Y-%m-%d %X'; do sleep 1; done
#
#     colors {
#         statusline $text
#         background $base
#         focused_workspace $lavender $base $lavender
#         active_workspace $surface1 $base $subtext1
#         inactive_workspace $base $base $overlay0
#         urgent_workspace $red $base $red
#     }
# }

# Start sway-session.target for systemd user services that depend on Sway
exec systemctl --user start sway-session.target

# I'm on Arch, so this includes additional systemd configuration. Don't remove.
include /etc/sway/config.d/*
