# Completion for: u mysql replace-db <database> <sql_file>
# COMP_WORDS: [0]=u, [1]=mysql, [2]=replace-db, [3]=database, [4]=sql_file

local cur="${COMP_WORDS[COMP_CWORD]}"

# Third argument: MySQL database names
if [[ $COMP_CWORD -eq 3 ]]; then
  local databases
  databases=$(mysql -N -B -e "SHOW DATABASES" 2>/dev/null | grep -v -E '^(information_schema|performance_schema|mysql|sys)$')
  mapfile -t COMPREPLY < <(compgen -W "$databases" -- "$cur")
  return 0
fi

# Fourth argument: file completion
compopt -o default
